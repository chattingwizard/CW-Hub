import{B as h,D as p,r,s as b,j as e,E as c}from"./index-BP5YFlyp.js";import{C as d}from"./circle-alert-CfHPc9GY.js";function g(){const{moduleId:m}=h(),s=p.find(t=>t.id===m),[x,i]=r.useState(!0),[a,f]=r.useState(!1),n=r.useRef(null),u=r.useCallback(async()=>{var t;i(!1);try{const{data:{session:l}}=await b.auth.getSession();l&&((t=n.current)!=null&&t.contentWindow)&&n.current.contentWindow.postMessage({type:"cw-hub-session",access_token:l.access_token,refresh_token:l.refresh_token},"*")}catch{}},[]);if(!s||s.type!=="iframe")return e.jsx("div",{className:"p-6 flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{size:32,className:"text-text-muted mx-auto mb-3"}),e.jsx("p",{className:"text-text-secondary",children:"Module not found."})]})});const o=s.path;return e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"h-10 bg-surface-1 border-b border-border flex items-center justify-between px-4 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-white font-medium",children:s.name}),x&&!a&&e.jsx("div",{className:"w-3 h-3 border-2 border-cw/30 border-t-cw rounded-full animate-spin"})]}),e.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-xs text-text-secondary hover:text-cw transition-colors",children:["Open in new tab",e.jsx(c,{size:12})]})]}),a&&e.jsx("div",{className:"flex-1 flex items-center justify-center bg-surface-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{size:40,className:"text-warning mx-auto mb-4"}),e.jsxs("h3",{className:"text-lg font-semibold text-white mb-2",children:["Could not load ",s.name]}),e.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"The module might not be deployed yet or may have a different URL."}),e.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-cw hover:bg-cw-dark text-white rounded-lg text-sm font-medium",children:["Try opening directly",e.jsx(c,{size:14})]})]})}),e.jsx("iframe",{ref:n,src:o,className:`flex-1 w-full border-0 bg-surface-0 ${a?"hidden":""}`,title:s.name,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",allow:"clipboard-write",referrerPolicy:"no-referrer",onLoad:u,onError:()=>{i(!1),f(!0)}})]})}export{g as default};
