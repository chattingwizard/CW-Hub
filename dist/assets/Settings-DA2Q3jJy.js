const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DocPermissions-lcyooupq.js","assets/index-5iJEKlj_.js","assets/index-DeRXqBbJ.css","assets/search-DFjjBV4e.js","assets/check-ZKsHYW2K.js","assets/x-BzIecsSZ.js"])))=>i.map(i=>d[i]);
import{c as w,u as E,r,s as d,j as e,z as L,U as T,_ as M}from"./index-5iJEKlj_.js";import{R as P}from"./refresh-cw-DxoFjCnl.js";import{C as $}from"./check-ZKsHYW2K.js";import{C as I}from"./copy-CXUxh1bm.js";import{S as D}from"./search-DFjjBV4e.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=w("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=w("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),O=r.lazy(()=>M(()=>import("./DocPermissions-lcyooupq.js"),__vite__mapDeps([0,1,2,3,4,5])));function Y(){const{profile:o}=E(),[x,u]=r.useState("users"),[y,N]=r.useState([]),[h,_]=r.useState([]),[C,p]=r.useState(!0),[S,n]=r.useState(null),[m,c]=r.useState(""),[b,g]=r.useState(!1),[l,k]=r.useState(""),i=r.useCallback(async()=>{p(!0);const[s,t]=await Promise.all([d.rpc("hub_get_users"),d.from("invite_codes").select("*").order("created_at",{ascending:!1}).limit(20)]);N(s.data??[]),_(t.data??[]),p(!1)},[]);r.useEffect(()=>{i()},[i]);const z=async(s,t)=>{try{const{error:a}=await d.rpc("hub_set_user_role",{target_id:s,new_role:t});if(a)throw a;c("Role updated"),i(),setTimeout(()=>c(""),2e3)}catch(a){c(`Error: ${a.message}`)}},R=async()=>{g(!0);try{const{data:s,error:t}=await d.rpc("generate_invite_code");if(t)throw t;i(),s&&(navigator.clipboard.writeText(s),n(s),c("Code generated and copied!"),setTimeout(()=>{n(null),c("")},3e3))}catch(s){c(`Error: ${s.message}`)}finally{g(!1)}},U=s=>{navigator.clipboard.writeText(s),n(s),setTimeout(()=>n(null),2e3)},A=s=>({owner:"bg-cw/15 text-cw border-cw/30",admin:"bg-purple-500/15 text-purple-400 border-purple-500/30",chatter_manager:"bg-blue-500/15 text-blue-400 border-blue-500/30",team_leader:"bg-orange-500/15 text-orange-400 border-orange-500/30",script_manager:"bg-pink-500/15 text-pink-400 border-pink-500/30",personal_assistant:"bg-teal-500/15 text-teal-400 border-teal-500/30",va:"bg-indigo-500/15 text-indigo-400 border-indigo-500/30",chatter:"bg-success/15 text-success border-success/30",recruit:"bg-warning/15 text-warning border-warning/30"})[s]??"bg-surface-3 text-text-secondary border-border",f=y.filter(s=>{var a,j,v;if(!l)return!0;const t=l.toLowerCase();return((a=s.full_name)==null?void 0:a.toLowerCase().includes(t))||((j=s.email)==null?void 0:j.toLowerCase().includes(t))||((v=s.role)==null?void 0:v.toLowerCase().includes(t))});return e.jsxs("div",{className:"p-4 lg:p-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-cw/10 flex items-center justify-center",children:e.jsx(L,{size:20,className:"text-cw"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Settings"}),e.jsx("p",{className:"text-sm text-text-secondary",children:"Manage users, roles, and permissions"})]})]}),m&&e.jsx("span",{className:`text-sm px-3 py-1 rounded-lg ${m.startsWith("Error")?"bg-danger/10 text-danger":"bg-success/10 text-success"}`,children:m})]}),e.jsxs("div",{className:"flex flex-wrap gap-1 bg-surface-2 rounded-xl p-1 mb-6 w-fit",children:[e.jsxs("button",{onClick:()=>u("users"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${x==="users"?"bg-surface-3 text-white shadow-sm":"text-text-muted hover:text-white"}`,children:[e.jsx(T,{size:15})," Users & Invites"]}),e.jsxs("button",{onClick:()=>u("doc-permissions"),className:`flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg transition-colors ${x==="doc-permissions"?"bg-surface-3 text-white shadow-sm":"text-text-muted hover:text-white"}`,children:[e.jsx(G,{size:15})," Doc Permissions"]})]}),x==="doc-permissions"?e.jsx(r.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-4 h-4 border-2 border-cw/30 border-t-cw rounded-full animate-spin"})}),children:e.jsx(O,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-surface-1 border border-border rounded-xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Invite Codes"}),e.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:"Generate codes for new team members to register"})]}),e.jsxs("button",{onClick:R,disabled:b,className:"flex items-center gap-2 px-4 py-2 bg-cw hover:bg-cw-dark text-white rounded-lg text-sm font-medium disabled:opacity-50",children:[b?e.jsx(P,{size:16,className:"animate-spin"}):e.jsx(V,{size:16}),"Generate Code"]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:h.length===0?e.jsx("p",{className:"text-sm text-text-muted py-4 text-center",children:"No invite codes generated yet."}):h.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-surface-2 rounded-lg px-4 py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("code",{className:"text-sm text-cw font-mono",children:s.code}),s.used_by?e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-surface-3 text-text-muted",children:"Used"}):e.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-success/15 text-success",children:"Available"})]}),e.jsx("button",{onClick:()=>U(s.code),className:"p-1.5 rounded-lg hover:bg-surface-3 text-text-secondary hover:text-white",title:"Copy code",children:S===s.code?e.jsx($,{size:14,className:"text-success"}):e.jsx(I,{size:14})})]},s.code))})]}),e.jsxs("div",{className:"bg-surface-1 border border-border rounded-xl overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-border flex items-center justify-between gap-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white shrink-0",children:"Team Members"}),e.jsxs("div",{className:"relative max-w-xs flex-1",children:[e.jsx(D,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{type:"text",value:l,onChange:s=>k(s.target.value),placeholder:"Search users...",className:"w-full bg-surface-2 border border-border rounded-lg pl-8 pr-3 py-2 text-sm text-white placeholder-text-muted focus:outline-none focus:border-cw"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsx("tr",{className:"border-b border-border",children:["Name","Email","Role","Status","Actions"].map(s=>e.jsx("th",{className:"text-left px-5 py-3 text-text-secondary font-medium text-xs uppercase tracking-wider",children:s},s))})}),e.jsx("tbody",{children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-5 py-8 text-center text-text-secondary",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-cw/30 border-t-cw rounded-full animate-spin"}),"Loading..."]})})}):f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-5 py-8 text-center text-text-muted",children:l?"No users match your search.":"No users found."})}):f.map(s=>e.jsxs("tr",{className:"border-b border-border/50 hover:bg-surface-2/50",children:[e.jsx("td",{className:"px-5 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-cw/15 flex items-center justify-center text-cw text-xs font-medium shrink-0",children:(s.full_name||s.email).charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("span",{className:"text-white",children:s.full_name||"â€”"}),s.team_name&&e.jsx("p",{className:"text-[10px] text-text-muted",children:s.team_name})]})]})}),e.jsx("td",{className:"px-5 py-3 text-text-secondary text-xs",children:s.email}),e.jsx("td",{className:"px-5 py-3",children:e.jsx("span",{className:`inline-block px-2.5 py-0.5 rounded-full text-xs border ${A(s.role)}`,children:s.role})}),e.jsx("td",{className:"px-5 py-3",children:e.jsxs("span",{className:`flex items-center gap-1.5 text-xs ${s.is_active!==!1?"text-success":"text-danger"}`,children:[e.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${s.is_active!==!1?"bg-success":"bg-danger"}`}),s.is_active!==!1?"Active":"Inactive"]})}),e.jsx("td",{className:"px-5 py-3",children:s.id!==(o==null?void 0:o.id)?e.jsxs("select",{value:s.role,onChange:t=>z(s.id,t.target.value),className:"bg-surface-2 border border-border rounded-lg px-2.5 py-1.5 text-xs text-white focus:border-cw focus:outline-none",children:[e.jsx("option",{value:"recruit",children:"Recruit"}),e.jsx("option",{value:"chatter",children:"Chatter"}),e.jsx("option",{value:"va",children:"VA"}),e.jsx("option",{value:"personal_assistant",children:"Personal Assistant"}),e.jsx("option",{value:"script_manager",children:"Script Manager"}),e.jsx("option",{value:"team_leader",children:"Team Leader"}),e.jsx("option",{value:"chatter_manager",children:"Chatter Manager"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"owner",children:"Owner"})]}):e.jsx("span",{className:"text-xs text-text-muted",children:"You"})})]},s.id))})]})})]})]})]})}export{Y as default};
