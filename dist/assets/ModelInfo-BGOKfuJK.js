import{u as P,r as d,s as z,j as e,a as m,F as R,G as T,U as q,f as w,E as F}from"./index-5iJEKlj_.js";import{u as O,P as D}from"./useTrafficData-D6cOhIJd.js";import{M as U}from"./ModelAvatar-fBwECrXT.js";import{S as B}from"./search-DFjjBV4e.js";import{D as I}from"./dollar-sign-BNmQvkGT.js";import{T as $}from"./trending-up-D8RIYaxq.js";import{X as G}from"./x-BzIecsSZ.js";import"./trending-down-DuzWBKUD.js";import"./minus-BhOD4fh2.js";function ee(){const{profile:a}=P(),[t,o]=d.useState([]),[S,f]=d.useState([]),[h,j]=d.useState([]),[l,N]=d.useState(!0),[i,v]=d.useState(""),[x,g]=d.useState("Live"),[c,_]=d.useState(null),{getModelTraffic:k}=O(),A=d.useCallback(async()=>{N(!0);const[s,r,n]=await Promise.all([z.from("models").select("*").order("name"),z.from("chatters").select("*").eq("status","Active").eq("airtable_role","Chatter"),z.from("model_chatter_assignments").select("*").eq("active",!0)]);o(s.data??[]),f(r.data??[]),j(n.data??[]),N(!1)},[]);d.useEffect(()=>{A()},[A]);const E=d.useMemo(()=>[...new Set(t.map(s=>s.status))].sort(),[t]),C=d.useMemo(()=>{let s=t;if(x!=="all"&&(s=s.filter(r=>r.status===x)),i){const r=i.toLowerCase();s=s.filter(n=>{var y,b;return n.name.toLowerCase().includes(r)||((y=n.niche)==null?void 0:y.some(p=>p.toLowerCase().includes(r)))||((b=n.client_name)==null?void 0:b.toLowerCase().includes(r))})}return s},[t,x,i]),M=s=>{const r=h.filter(n=>n.model_id===s).map(n=>n.chatter_id);return S.filter(n=>r.includes(n.id))};return e.jsxs("div",{className:"p-4 lg:p-6 h-[calc(100vh-56px)] lg:h-screen flex flex-col",children:[e.jsxs("div",{className:"mb-4 shrink-0",children:[e.jsx("h1",{className:"text-2xl font-extrabold text-text-primary",children:"Model Info"}),e.jsxs("p",{className:"text-text-secondary text-sm mt-0.5",children:[C.length," models · Profiles, chatters, revenue, and scripts"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4 shrink-0",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(B,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search by name, niche, or client...",value:i,onChange:s=>v(s.target.value),className:"w-full pl-8 pr-3 py-2 bg-surface-1 border border-border rounded-lg text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-cw/50"})]}),e.jsxs("div",{className:"flex gap-1.5 flex-wrap",children:[e.jsxs("button",{onClick:()=>g("all"),className:m("px-3 py-1.5 rounded-lg text-xs font-medium border transition-colors",x==="all"?"bg-cw/15 text-cw border-cw/30":"bg-surface-1 text-text-secondary border-border hover:border-text-muted"),children:["All (",t.length,")"]}),E.map(s=>e.jsxs("button",{onClick:()=>g(s),className:m("px-3 py-1.5 rounded-lg text-xs font-medium border transition-colors",x===s?(T[s]||"bg-cw/15 text-cw")+" border-transparent":"bg-surface-1 text-text-secondary border-border hover:border-text-muted"),children:[s," (",t.filter(r=>r.status===s).length,")"]},s))]})]}),e.jsxs("div",{className:"flex gap-4 flex-1 min-h-0",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:l?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-3",children:Array.from({length:9}).map((s,r)=>e.jsx("div",{className:"bg-surface-1 border border-border rounded-xl p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-surface-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-4 bg-surface-3 rounded w-24"}),e.jsx("div",{className:"h-3 bg-surface-3 rounded w-16 mt-1.5"})]})]})},r))}):C.length===0?e.jsxs("div",{className:"bg-surface-1 border border-border rounded-xl p-12 text-center",children:[e.jsx(R,{size:32,className:"mx-auto text-text-muted mb-3"}),e.jsx("p",{className:"text-text-muted text-sm",children:i?"No models match your search":"No models available"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-2",children:C.map(s=>{var b;const r=k(s.id),n=h.filter(p=>p.model_id===s.id).length,y=(c==null?void 0:c.id)===s.id;return e.jsxs("button",{onClick:()=>_(s),className:m("bg-surface-1 border rounded-xl p-4 text-left transition-all",y?"border-cw/50 ring-1 ring-cw/20":"border-border hover:border-border-light"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(U,{name:s.name,pictureUrl:s.profile_picture_url,size:"md"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-text-primary text-sm truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx("span",{className:m("text-[10px] px-1.5 py-0.5 rounded-full font-medium",T[s.status]||"bg-surface-3 text-text-muted"),children:s.status}),e.jsx(D,{pageType:s.page_type,size:"sm"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-text-muted",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{size:10}),n," chatters"]}),r&&r.earnings_per_day>0&&e.jsxs("span",{className:"flex items-center gap-1 text-success",children:[e.jsx(I,{size:10}),w(r.earnings_per_day),"/d"]}),r&&r.new_fans_avg>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{size:10}),Math.round(r.new_fans_avg)," fans/d"]})]}),((b=s.niche)==null?void 0:b.length)>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[s.niche.slice(0,3).map(p=>e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-surface-2 text-text-muted",children:p},p)),s.niche.length>3&&e.jsxs("span",{className:"text-[9px] text-text-muted",children:["+",s.niche.length-3]})]})]},s.id)})})}),c&&e.jsx("div",{className:"hidden lg:block w-96 shrink-0 bg-surface-1 border border-border rounded-xl overflow-y-auto",children:e.jsx(L,{model:c,traffic:k(c.id),chatters:M(c.id),onClose:()=>_(null)})})]}),c&&e.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>_(null)}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-full max-w-sm bg-surface-1 border-l border-border overflow-y-auto",children:e.jsx(L,{model:c,traffic:k(c.id),chatters:M(c.id),onClose:()=>_(null)})})]})]})}function L({model:a,traffic:t,chatters:o,onClose:S}){var f,h,j;return e.jsxs("div",{children:[e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{name:a.name,pictureUrl:a.profile_picture_url,size:"lg"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-extrabold text-text-primary",children:a.name}),e.jsxs("p",{className:"text-xs text-text-secondary mt-0.5",children:[a.client_name||"No client"," · ",a.page_type||"Unknown type"]})]})]}),e.jsx("button",{onClick:S,className:"p-1.5 rounded-lg hover:bg-surface-2 text-text-muted",children:e.jsx(G,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:m("text-xs px-2 py-0.5 rounded-full font-medium",T[a.status]||"bg-surface-3 text-text-muted"),children:a.status}),e.jsx(D,{pageType:a.page_type,size:"sm"}),a.chatbot_active&&e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-purple-500/15 text-purple-400 font-medium",children:"Chatbot ON"})]})]}),t&&e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsx("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:"Revenue & Traffic"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(u,{label:"Revenue/day",value:t.earnings_per_day>0?w(t.earnings_per_day):"—",color:t.earnings_per_day>0?"text-success":""}),e.jsx(u,{label:"Tips/day",value:t.tips_per_day>0?w(t.tips_per_day):"—"}),e.jsx(u,{label:"New fans/day",value:t.new_fans_avg>0?String(Math.round(t.new_fans_avg)):"—"}),e.jsx(u,{label:"Active fans",value:t.active_fans>0?String(t.active_fans):"—"}),e.jsx(u,{label:"Renew rate",value:t.renew_pct>0?`${t.renew_pct.toFixed(1)}%`:"—"}),e.jsx(u,{label:"Avg $/spender",value:t.avg_spend_per_spender>0?w(t.avg_spend_per_spender):"—"})]})]}),e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsxs("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:["Assigned Chatters (",o.length,")"]}),o.length===0?e.jsx("p",{className:"text-xs text-text-muted py-2",children:"No chatters assigned"}):e.jsx("div",{className:"space-y-1.5",children:o.map(l=>{var i,v,x,g;const N=(i=l.team_name)!=null&&i.includes("Huckle")?"bg-orange-400":(v=l.team_name)!=null&&v.includes("Danilyn")?"bg-blue-400":(x=l.team_name)!=null&&x.includes("Ezekiel")?"bg-purple-400":"bg-zinc-500";return e.jsxs("div",{className:"flex items-center gap-2.5 px-3 py-2 rounded-lg bg-surface-2",children:[e.jsx("div",{className:m("w-2 h-2 rounded-full",N)}),e.jsx("span",{className:"text-sm text-text-primary font-medium flex-1",children:l.full_name}),e.jsx("span",{className:"text-[10px] text-text-muted",children:(g=l.team_name)==null?void 0:g.replace("Team ","")})]},l.id)})})]}),((f=a.team_names)==null?void 0:f.length)>0&&e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsx("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:"Teams"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.team_names.map(l=>e.jsx("span",{className:"text-xs px-2.5 py-1 rounded-lg bg-surface-2 text-text-secondary font-medium",children:l},l))})]}),e.jsxs("div",{className:"p-5 border-b border-border",children:[e.jsx("h3",{className:"text-xs font-bold text-text-muted uppercase tracking-wider mb-3",children:"Details"}),((h=a.niche)==null?void 0:h.length)>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1.5",children:"Niche"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.niche.map(l=>e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-md bg-surface-2 text-text-secondary",children:l},l))})]}),((j=a.traffic_sources)==null?void 0:j.length)>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] text-text-muted mb-1.5",children:"Traffic Sources"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.traffic_sources.map(l=>e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-md bg-surface-2 text-text-secondary",children:l},l))})]})]}),e.jsx("div",{className:"p-5",children:a.scripts_url&&e.jsxs("a",{href:a.scripts_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full px-4 py-2.5 bg-cw/10 text-cw text-sm font-bold rounded-lg hover:bg-cw/20 transition-colors",children:[e.jsx(R,{size:16}),"View Scripts",e.jsx(F,{size:12})]})})]})}function u({label:a,value:t,color:o=""}){return e.jsxs("div",{className:"bg-surface-2 rounded-lg p-2.5",children:[e.jsx("p",{className:"text-[10px] text-text-muted uppercase tracking-wide",children:a}),e.jsx("p",{className:m("text-sm font-bold mt-0.5",o||"text-text-primary"),children:t})]})}export{ee as default};
